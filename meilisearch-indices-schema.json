{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "PhilGEPS MeiliSearch Indices Schema",
  "description": "Complete schema definition for all MeiliSearch indices used in the PhilGEPS Transparency Dashboard",
  "version": "1.0.0",
  "indices": [
    {
      "name": "philgeps",
      "description": "Main PhilGEPS government procurement contracts and awards index",
      "primaryKey": "id",
      "documentCount": "~2.5M records",
      "documentSchema": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "description": "Unique document identifier"
          },
          "reference_id": {
            "type": "string",
            "description": "Reference ID from PhilGEPS"
          },
          "contract_no": {
            "type": "string",
            "description": "Contract number"
          },
          "award_title": {
            "type": "string",
            "description": "Title of the award"
          },
          "notice_title": {
            "type": "string",
            "description": "Title of the procurement notice"
          },
          "awardee_name": {
            "type": "string",
            "description": "Name of the contractor/awardee"
          },
          "organization_name": {
            "type": "string",
            "description": "Name of the procuring organization"
          },
          "area_of_delivery": {
            "type": "string",
            "description": "Location/area of delivery"
          },
          "business_category": {
            "type": "string",
            "description": "Category of business/procurement (e.g., Construction, IT, Medical)"
          },
          "contract_amount": {
            "type": "number",
            "description": "Contract amount in PHP"
          },
          "award_date": {
            "type": "string",
            "format": "date",
            "description": "Date of award"
          },
          "award_status": {
            "type": "string",
            "description": "Status of the award"
          }
        },
        "required": ["id"]
      },
      "settings": {
        "searchableAttributes": [
          "reference_id",
          "contract_no",
          "award_title",
          "notice_title",
          "awardee_name",
          "organization_name",
          "area_of_delivery",
          "business_category"
        ],
        "filterableAttributes": [
          "awardee_name",
          "organization_name",
          "area_of_delivery",
          "business_category"
        ],
        "sortableAttributes": [
          "contract_amount",
          "award_date"
        ],
        "separatorTokens": [" ", "-", "|", "/"],
        "nonSeparatorTokens": [".", "&", ",", "'"],
        "pagination": {
          "maxTotalHits": 10000
        }
      }
    },
    {
      "name": "philgeps_area_of_deliveries",
      "description": "Aggregated location/area of delivery data with counts and totals",
      "primaryKey": "auto-generated",
      "documentCount": "~thousands",
      "documentSchema": {
        "type": "object",
        "properties": {
          "area_of_delivery": {
            "type": "string",
            "description": "Location or area name"
          },
          "count": {
            "type": "integer",
            "description": "Number of contracts in this area"
          },
          "total": {
            "type": "number",
            "description": "Total contract amount for this area"
          },
          "start_date": {
            "type": "string",
            "format": "date",
            "description": "Earliest contract date"
          },
          "end_date": {
            "type": "string",
            "format": "date",
            "description": "Latest contract date"
          }
        }
      },
      "settings": {
        "searchableAttributes": ["area_of_delivery"],
        "filterableAttributes": ["total", "count", "start_date", "end_date"],
        "sortableAttributes": ["total", "count"]
      }
    },
    {
      "name": "philgeps_awardees",
      "description": "Aggregated awardee/contractor data with counts and totals",
      "primaryKey": "auto-generated",
      "documentCount": "~hundreds of thousands",
      "documentSchema": {
        "type": "object",
        "properties": {
          "awardee_name": {
            "type": "string",
            "description": "Name of the contractor/awardee"
          },
          "count": {
            "type": "integer",
            "description": "Number of contracts won by this awardee"
          },
          "total": {
            "type": "number",
            "description": "Total contract amount for this awardee"
          },
          "start_date": {
            "type": "string",
            "format": "date",
            "description": "Earliest contract date"
          },
          "end_date": {
            "type": "string",
            "format": "date",
            "description": "Latest contract date"
          }
        }
      },
      "settings": {
        "searchableAttributes": ["awardee_name"],
        "filterableAttributes": ["total", "count", "start_date", "end_date"],
        "sortableAttributes": ["total", "count"]
      }
    },
    {
      "name": "philgeps_business_categories",
      "description": "Aggregated business category data with counts and totals",
      "primaryKey": "auto-generated",
      "documentCount": "~hundreds",
      "documentSchema": {
        "type": "object",
        "properties": {
          "business_category": {
            "type": "string",
            "description": "Business or procurement category"
          },
          "count": {
            "type": "integer",
            "description": "Number of contracts in this category"
          },
          "total": {
            "type": "number",
            "description": "Total contract amount for this category"
          },
          "start_date": {
            "type": "string",
            "format": "date",
            "description": "Earliest contract date"
          },
          "end_date": {
            "type": "string",
            "format": "date",
            "description": "Latest contract date"
          }
        }
      },
      "settings": {
        "searchableAttributes": ["business_category"],
        "filterableAttributes": ["total", "count", "start_date", "end_date"],
        "sortableAttributes": ["total", "count"]
      }
    },
    {
      "name": "philgeps_organizations",
      "description": "Aggregated procuring organization data with counts and totals",
      "primaryKey": "auto-generated",
      "documentCount": "~thousands",
      "documentSchema": {
        "type": "object",
        "properties": {
          "organization_name": {
            "type": "string",
            "description": "Name of the procuring organization"
          },
          "count": {
            "type": "integer",
            "description": "Number of contracts by this organization"
          },
          "total": {
            "type": "number",
            "description": "Total contract amount for this organization"
          },
          "start_date": {
            "type": "string",
            "format": "date",
            "description": "Earliest contract date"
          },
          "end_date": {
            "type": "string",
            "format": "date",
            "description": "Latest contract date"
          }
        }
      },
      "settings": {
        "searchableAttributes": ["organization_name"],
        "filterableAttributes": ["total", "count", "start_date", "end_date"],
        "sortableAttributes": ["total", "count"]
      }
    },
    {
      "name": "gaa",
      "description": "General Appropriations Act (GAA) - Philippine National Budget data by line item",
      "primaryKey": "id",
      "documentCount": "~millions",
      "documentSchema": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "description": "Unique document identifier"
          },
          "year": {
            "type": "integer",
            "description": "Budget year (2020-2025)"
          },
          "agency": {
            "type": "string",
            "description": "Agency code"
          },
          "department": {
            "type": "string",
            "description": "Department code"
          },
          "uacs_dpt_dsc": {
            "type": "string",
            "description": "Department description"
          },
          "uacs_agy_dsc": {
            "type": "string",
            "description": "Agency description"
          },
          "dsc": {
            "type": "string",
            "description": "Item description"
          },
          "amt": {
            "type": "number",
            "description": "Budget amount in PHP"
          },
          "uacs_oper_dsc": {
            "type": "string",
            "description": "Operating unit description"
          },
          "uacs_fundsubcat_dsc": {
            "type": "string",
            "description": "Fund subcategory description"
          },
          "uacs_exp_cd": {
            "type": "string",
            "description": "Expense code"
          },
          "uacs_exp_dsc": {
            "type": "string",
            "description": "Expense description"
          },
          "uacs_sobj_cd": {
            "type": "string",
            "description": "Object code (enables object filtering)"
          },
          "uacs_sobj_dsc": {
            "type": "string",
            "description": "Object description"
          },
          "uacs_div_dsc": {
            "type": "string",
            "description": "Division description"
          }
        },
        "required": ["id"]
      },
      "settings": {
        "searchableAttributes": [
          "dsc",
          "uacs_dpt_dsc",
          "uacs_agy_dsc",
          "uacs_oper_dsc",
          "uacs_fundsubcat_dsc",
          "uacs_exp_dsc",
          "uacs_sobj_dsc",
          "uacs_div_dsc"
        ],
        "filterableAttributes": [
          "year",
          "department",
          "uacs_dpt_dsc",
          "agency",
          "uacs_agy_dsc",
          "uacs_oper_dsc",
          "uacs_fundsubcat_dsc",
          "uacs_exp_cd",
          "uacs_exp_dsc",
          "uacs_sobj_cd",
          "uacs_sobj_dsc",
          "uacs_div_dsc",
          "amt"
        ],
        "sortableAttributes": [
          "year",
          "amt"
        ],
        "pagination": {
          "maxTotalHits": 10000
        }
      }
    },
    {
      "name": "dpwh",
      "description": "DPWH (Department of Public Works and Highways) Infrastructure Projects",
      "primaryKey": "contractId",
      "documentCount": "~248,220 projects",
      "documentSchema": {
        "type": "object",
        "properties": {
          "contractId": {
            "type": "string",
            "description": "Unique contract identifier"
          },
          "description": {
            "type": "string",
            "description": "Project description"
          },
          "category": {
            "type": "string",
            "description": "Infrastructure category (e.g., Roads, Bridges, Flood Control)"
          },
          "componentCategories": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Array of component categories"
          },
          "status": {
            "type": "string",
            "enum": ["Completed", "On-Going", "For Procurement", "Not Yet Started", "Terminated"],
            "description": "Project status"
          },
          "location": {
            "type": "object",
            "properties": {
              "region": {
                "type": "string",
                "description": "Philippine region"
              },
              "province": {
                "type": "string",
                "description": "Province"
              },
              "municipality": {
                "type": "string",
                "description": "Municipality (optional)"
              },
              "barangay": {
                "type": "string",
                "description": "Barangay (optional)"
              }
            }
          },
          "contractor": {
            "type": "string",
            "description": "Contractor name"
          },
          "programName": {
            "type": "string",
            "description": "Program name"
          },
          "sourceOfFunds": {
            "type": "string",
            "description": "Source of funding"
          },
          "budget": {
            "type": "number",
            "description": "Project budget in PHP"
          },
          "amountPaid": {
            "type": "number",
            "description": "Amount paid to date in PHP"
          },
          "progress": {
            "type": "number",
            "description": "Project completion progress percentage (0-100)"
          },
          "isLive": {
            "type": "boolean",
            "description": "Whether project has live monitoring"
          },
          "livestreamUrl": {
            "type": "string",
            "description": "URL to livestream (if available)"
          },
          "infraYear": {
            "type": "integer",
            "description": "Infrastructure year (2016-2026)"
          },
          "reportCount": {
            "type": "integer",
            "description": "Number of reports"
          },
          "startDate": {
            "type": "string",
            "format": "date",
            "description": "Project start date"
          },
          "completionDate": {
            "type": "string",
            "format": "date",
            "description": "Project completion date"
          },
          "latitude": {
            "type": "number",
            "description": "Latitude coordinate"
          },
          "longitude": {
            "type": "number",
            "description": "Longitude coordinate"
          },
          "hasSatelliteImage": {
            "type": "boolean",
            "description": "Whether satellite imagery is available"
          }
        },
        "required": ["contractId"]
      },
      "settings": {
        "searchableAttributes": [
          "contractId",
          "description",
          "category",
          "componentCategories",
          "location.province",
          "location.region",
          "contractor",
          "programName",
          "sourceOfFunds"
        ],
        "filterableAttributes": [
          "contractId",
          "category",
          "contractor",
          "componentCategories",
          "status",
          "location.province",
          "location.region",
          "infraYear",
          "programName",
          "isLive",
          "hasSatelliteImage",
          "progress",
          "budget",
          "amountPaid"
        ],
        "sortableAttributes": [
          "budget",
          "amountPaid",
          "progress",
          "startDate",
          "completionDate",
          "infraYear",
          "reportCount"
        ],
        "displayedAttributes": [
          "contractId",
          "description",
          "category",
          "componentCategories",
          "status",
          "budget",
          "amountPaid",
          "progress",
          "location",
          "contractor",
          "startDate",
          "completionDate",
          "infraYear",
          "programName",
          "sourceOfFunds",
          "isLive",
          "livestreamUrl",
          "latitude",
          "longitude",
          "reportCount",
          "hasSatelliteImage"
        ],
        "rankingRules": [
          "words",
          "typo",
          "proximity",
          "attribute",
          "sort",
          "exactness"
        ],
        "separatorTokens": [" ", "-", "|", "/", ","],
        "nonSeparatorTokens": [".", "&", "'", "(", ")"],
        "pagination": {
          "maxTotalHits": 10000
        }
      }
    }
  ],
  "metadata": {
    "environment": {
      "host": "${VITE_MEILISEARCH_HOST}",
      "apiKey": "${VITE_MEILISEARCH_API_KEY}",
      "defaultIndex": "${VITE_MEILISEARCH_INDEX_NAME}"
    },
    "totalIndices": 7,
    "categories": {
      "procurement": ["philgeps", "philgeps_area_of_deliveries", "philgeps_awardees", "philgeps_business_categories", "philgeps_organizations"],
      "budget": ["gaa"],
      "infrastructure": ["dpwh"]
    },
    "notes": [
      "All indices use MeiliSearch v1.0+",
      "Primary keys are either auto-generated or explicitly set during import",
      "Pagination is limited to 10,000 total hits per index",
      "All date fields are stored in ISO 8601 format",
      "Currency amounts are stored as numbers in Philippine Peso (PHP)",
      "Configure indices using shell scripts in data/<index-name>/configure_meilisearch.sh"
    ]
  },
  "staticDatasets": {
    "description": "Static JSON and CSV datasets served from /public/data that do not use MeiliSearch",
    "datasets": [
      {
        "category": "BIR Tax Collections",
        "description": "Bureau of Internal Revenue tax collection data aggregated for visualization",
        "basePath": "/data/bir/aggregates/",
        "sourceFiles": "data/bir/data/*.csv (2020-2024)",
        "scale": "Values in Philippine Pesos",
        "files": [
          {
            "name": "total_by_region.json",
            "size": "2.8 KB",
            "description": "Total tax collections aggregated by Philippine region",
            "schema": {
              "metadata": {
                "title": "string",
                "source": "string",
                "date_range": {"start": "YYYY-MM", "end": "YYYY-MM"},
                "total_records": "number"
              },
              "data": [
                {
                  "region": "string (e.g., 'NCR', 'Region I')",
                  "total": "number (total amount in PHP)"
                }
              ]
            }
          },
          {
            "name": "total_by_area.json",
            "size": "17.0 KB",
            "description": "Total tax collections by area/RDO with region context",
            "schema": {
              "data": [
                {
                  "region": "string",
                  "area": "string (RDO name)",
                  "total": "number"
                }
              ]
            }
          },
          {
            "name": "total_by_month.json",
            "size": "1.6 KB",
            "description": "Monthly totals across all years for seasonal pattern analysis"
          },
          {
            "name": "total_by_year.json",
            "size": "0.7 KB",
            "description": "Yearly totals for year-over-year trends (2020-2024)"
          },
          {
            "name": "region_by_year.json",
            "size": "10.6 KB",
            "description": "Time series data grouped by region showing yearly progression"
          },
          {
            "name": "monthly_time_series.json",
            "size": "7.6 KB",
            "description": "Granular month-by-month data points for timeline visualization"
          },
          {
            "name": "region_by_month.json",
            "size": "37.3 KB",
            "description": "Seasonal patterns per region showing monthly variations"
          },
          {
            "name": "area_by_year.json",
            "size": "93.3 KB",
            "description": "Area-level yearly data for detailed analysis"
          },
          {
            "name": "top_100_areas.json",
            "size": "18.7 KB",
            "description": "Rankings of top 100 performing areas by total collection"
          },
          {
            "name": "granular_data.json",
            "size": "1.1 MB",
            "description": "Complete dataset (region, area, month, year, amount) for custom client-side aggregation",
            "schema": {
              "data": [
                {
                  "region": "string",
                  "area": "string",
                  "month": "string (Jan-Dec)",
                  "month_num": "number (1-12)",
                  "year": "number",
                  "amount": "number (PHP)"
                }
              ]
            }
          },
          {
            "name": "gaa_by_region.json",
            "size": "11.8 KB",
            "description": "GAA (General Appropriations Act) budget allocations by region",
            "note": "Linked from BIR directory for regional budget comparison"
          }
        ]
      },
      {
        "category": "GAA Budget Aggregates",
        "description": "General Appropriations Act budget data aggregated by various dimensions",
        "basePath": "/data/gaa/aggregates/",
        "sourceFiles": "data/gaa/data/GAA-*.csv (2020-2025)",
        "scale": "Values in THOUSANDS of Philippine Pesos (multiply by 1,000 for actual amount)",
        "files": [
          {
            "name": "departments.json",
            "size": "28.8 KB",
            "description": "Department-level budget aggregates by year",
            "schema": {
              "metadata": {
                "title": "string",
                "source": "string",
                "total_items": "number"
              },
              "data": [
                {
                  "id": "string (department code)",
                  "description": "string (department name)",
                  "years": {
                    "2025": {"count": "number", "amount": "number (in thousands)"},
                    "2024": {"count": "number", "amount": "number (in thousands)"}
                  }
                }
              ]
            }
          },
          {
            "name": "agencies.json",
            "size": "353.6 KB",
            "description": "Agency-level budget aggregates linked to departments",
            "schema": {
              "data": [
                {
                  "id": "string (agency code)",
                  "description": "string",
                  "department_id": "string",
                  "years": {"YEAR": {"count": "number", "amount": "number"}}
                }
              ]
            }
          },
          {
            "name": "fund_subcategories.json",
            "size": "775.8 KB",
            "description": "Fund subcategory aggregates (e.g., Regular Agency Fund, Special Purpose Fund)"
          },
          {
            "name": "expenses.json",
            "size": "990.1 KB",
            "description": "Expense category aggregates by year"
          },
          {
            "name": "objects.json",
            "size": "21.7 MB",
            "description": "Object code-level aggregates (most granular budget line items)",
            "note": "Large file - contains detailed line-item budget allocations"
          },
          {
            "name": "yearly_totals.json",
            "size": "0.6 KB",
            "description": "Total budget per year (2020-2025) summary"
          }
        ]
      },
      {
        "category": "DPWH Infrastructure Aggregates",
        "description": "Department of Public Works and Highways project aggregates",
        "basePath": "/data/dpwh/aggregates/",
        "sourceFiles": "dpwh_transparency_data.parquet",
        "scale": "Budget and amount values in Philippine Pesos",
        "files": [
          {
            "name": "categories.json",
            "size": "51.6 KB",
            "description": "Infrastructure category aggregates (Roads, Bridges, Flood Control, etc.)",
            "schema": {
              "metadata": {
                "title": "string",
                "source": "string",
                "generated_at": "ISO 8601 datetime",
                "total_items": "number",
                "total_projects": "number",
                "total_budget": "number",
                "total_paid": "number",
                "avg_progress": "number"
              },
              "data": [
                {
                  "category": "string",
                  "project_count": "number",
                  "total_budget": "number",
                  "total_paid": "number",
                  "avg_budget": "number",
                  "avg_progress": "number",
                  "statuses": {"status_name": "count"}
                }
              ]
            }
          },
          {
            "name": "regions.json",
            "size": "13.0 KB",
            "description": "Regional infrastructure project aggregates",
            "schema": {
              "data": [
                {
                  "region": "string",
                  "province_count": "number",
                  "project_count": "number",
                  "total_budget": "number",
                  "total_paid": "number",
                  "avg_budget": "number",
                  "avg_progress": "number",
                  "top_categories": [{"category": "string", "count": "number"}]
                }
              ]
            }
          },
          {
            "name": "provinces.json",
            "size": "118.6 KB",
            "description": "Province-level infrastructure project aggregates with regional context"
          },
          {
            "name": "contractors.json",
            "size": "2.7 MB",
            "description": "Contractor performance aggregates across all projects",
            "schema": {
              "data": [
                {
                  "contractor": "string",
                  "project_count": "number",
                  "total_budget": "number",
                  "total_paid": "number",
                  "avg_budget": "number",
                  "avg_progress": "number"
                }
              ]
            }
          },
          {
            "name": "programs.json",
            "size": "0.8 KB",
            "description": "Program-level aggregates (infrastructure programs)"
          },
          {
            "name": "statuses.json",
            "size": "1.3 KB",
            "description": "Project status aggregates (Completed, On-Going, For Procurement, etc.)"
          },
          {
            "name": "years.json",
            "size": "3.9 KB",
            "description": "Year-by-year infrastructure project aggregates (2016-2026)"
          }
        ]
      },
      {
        "category": "Treasury Cash Operations",
        "description": "Bureau of Treasury Cash Operations Report (COR) data",
        "basePath": "/data/treasury/",
        "sourceFiles": "COR Excel/XML files parsed to CSV",
        "scale": "Values in THOUSANDS of Philippine Pesos",
        "files": [
          {
            "name": "cor_data.csv",
            "description": "Monthly cash operations data (revenues, expenditures, financing)",
            "format": "CSV",
            "schema": {
              "columns": [
                "year (number)",
                "month (string: Jan-Dec)",
                "category (string: Revenues, Expenditures, Financing, Surplus/(-)Deficit)",
                "subcategory (string: e.g., Tax Revenues, Non-Tax Revenues)",
                "line_item (string: e.g., BIR, BOC, Interest Payments)",
                "value (number: amount in thousands of PHP)"
              ]
            },
            "usage": "Loaded directly via fetch() and parsed in TreasuryOverview and TreasuryByYear components",
            "note": "Hierarchical structure: category > subcategory > line_item"
          }
        ]
      },
      {
        "category": "Geographic Reference Data",
        "description": "Philippine geographic boundaries and regions",
        "basePath": "/data/",
        "files": [
          {
            "name": "philippine-regions.json",
            "size": "933.7 KB",
            "description": "GeoJSON data for Philippine regional boundaries",
            "format": "GeoJSON",
            "usage": "Used for map visualizations and geographic queries"
          }
        ]
      }
    ]
  }
}
